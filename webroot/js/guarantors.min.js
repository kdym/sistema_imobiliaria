function setGuarantor(e){confirm("Tem certeza que deseja selecionar esse Fiador?")&&(startLoading("#search-users-box"),$.ajax({url:"/guarantors/add-existing.json",data:{user_id:e,contract_id:$("#contract-id").val()},type:"post",dataType:"json",success:function(e){switch(e){case"ok":location.href="/contracts/view/"+$("#contract-id").val();break;case"exists":alert("Fiador j√° cadastrado"),stopLoading("#search-users-box")}}}))}function getCivilState(){$("#married-box").hide(),$("#estado-civil").val()==$("#married-box").data("accepted-choice")&&$("#married-box").fadeIn()}$("#cep").blur(function(){getCep($(this),function(e){$("#endereco").val(e.logradouro),$("#bairro").val(e.bairro),$("#cidade").val(e.localidade),$("#uf").val(e.uf)})}),$("#search-user").length&&($("#search-user").autocomplete({source:function(e,a){$.ajax({url:"/guarantors/fetch-users.json",data:{name:e.term},dataType:"json",success:function(e){a(e)}})},select:function(e,a){return setGuarantor(a.item.id),!1}}).autocomplete("instance")._renderItem=function(e,a){var t={name:a.nome,username:a.formatted_username};return $("<li>").append($("#users-search-template").tmpl(t)).appendTo(e)}),$("#married-box").length&&(getCivilState(),$("#estado-civil").change(function(){getCivilState()}));