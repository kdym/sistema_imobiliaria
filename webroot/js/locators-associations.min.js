function setSlider(e){return $(e).bootstrapSlider({min:0,max:100,step:1,orientation:"horizontal",tooltip:"show",id:"blue",formatter:function(e){return e+"%"}}).on("slide",function(e){updateTotalPercentage()})}function associateLocator(e){if(confirm("Tem certeza que deseja associar esse Locador?")){var t=!1;$("#main-locator").data("locator-id")==e.locator.id&&(alert("Não é possível associar um Locador a ele mesmo"),t=!0);for(var a in locatorsSliders)a==e.locator.id&&(alert("Locador já associado"),t=!0);if(!t){mainSlider.bootstrapSlider("enable");var o={id:e.locator.id,name:e.nome,username:e.formatted_username,percentage:0},r=$("#locators-sliders-template").tmpl(o).appendTo(".percentage-sliders");locatorsSliders[e.locator.id]=setSlider(r.find(".slider")),r.find(".delete-button").click(function(){deleteSlider(this)})}$("#search-locator").val("")}}function updateTotalPercentage(){var e=mainSlider.bootstrapSlider("getValue");if(!isLocatorsSlidersEmpty())for(var t in locatorsSliders)e+=locatorsSliders[t].bootstrapSlider("getValue");var a=$("#total-percentage"),o=$("#save-button");a.html(e+"%"),a.removeClass("text-danger"),a.removeClass("text-success"),100!=e?(a.addClass("text-danger"),o.attr("disabled",!0)):(a.addClass("text-success"),o.attr("disabled",!1)),updateAssociatedLocatorsForm()}function deleteSlider(e){if(confirm("Tem certeza que deseja excluir?")){var t=$(e).closest(".associated-locator-row");delete locatorsSliders[t.data("locator-id")],t.fadeOut("fast",function(){t.remove(),isLocatorsSlidersEmpty()&&(mainSlider.bootstrapSlider("setValue",100),mainSlider.bootstrapSlider("disable")),updateTotalPercentage()})}}function isLocatorsSlidersEmpty(){var e=0;for(var t in locatorsSliders)e++;return 0==e}function updateAssociatedLocatorsForm(){$("#associate-locators-form").html(""),$(".associated-locator-row").each(function(){var e={id:$(this).data("locator-id"),percentage:locatorsSliders[$(this).data("locator-id")].bootstrapSlider("getValue")};$("#associate-locators-form-template").tmpl(e).appendTo("#associate-locators-form")})}var mainSlider,locatorsSliders={};$("#main-slider").length&&(mainSlider=setSlider("#main-slider"),$(".associated-locator-row").each(function(){locatorsSliders[$(this).data("locator-id")]=setSlider($(this).find(".slider")),$(this).find(".delete-button").click(function(){deleteSlider(this)})}),updateTotalPercentage()),$("#search-locator").length&&($("#search-locator").autocomplete({source:function(e,t){$.ajax({url:"/locators/fetch.json",data:{name:e.term},dataType:"json",success:function(e){t(e)}})},select:function(e,t){return associateLocator(t.item),!1}}).autocomplete("instance")._renderItem=function(e,t){var a={name:t.nome,username:t.formatted_username};return $("<li>").append($("#locators-search-template").tmpl(a)).appendTo(e)});